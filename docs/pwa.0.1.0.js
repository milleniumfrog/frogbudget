!function(e){function t(t){for(var a,i,l=t[0],c=t[1],u=t[2],p=0,d=[];p<l.length;p++)i=l[p],r[i]&&d.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(s&&s(t);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,l=1;l<n.length;l++){var c=n[l];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={0:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var s=c;o.push([37,2]),n()}({35:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),l=n(40),c=n(39),u=n(41),s=n(1);let p=Number(localStorage.getItem("entry_id"))||0;function d(){const e=String(++p);return localStorage.setItem("entry_id",e),e}var h=n(9),m=n(19),f=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};class y extends m.a{constructor(e={}){e.placeholders=[{keys:["{{timestamp}}"],flags:"gi",replacer:()=>{let e=new Date;return`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`}},{keys:["{{service}}"],flags:"gi",replacer:(e,t)=>t?`${t.service}`:"error_service"}],super(e)}construct(e){return f(this,void 0,void 0,function*(){return this.internals.service="CONSTRUCTOR",this.custom(this.options,this.internals,`Component ${e}`)})}}const g=new y({prefix:"{{timestamp}} [DB -- {{service}}] "}),E=new y({prefix:"{{timestamp}} [REDUX -- {{service}}] "}),v=new y({prefix:"{{timestamp}} [{{service}}] "});var w=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};const b=h.createInstance({name:"repeat"});function S(e){return w(this,void 0,void 0,function*(){return g.log("add Repeat"),yield b.setItem(e.id,e),e})}const T="ADD_REPEAT",D="SET_REPEATS";var C=n(8);const x="ADD_ENTRY",I="REMOVE_ENTRY",k="SET_ENTRIES",_="ADD_ENTRIES";let O=C.c(C.b({entryReducer:function(e=[],t){switch(E.log("call entry-reducer with action "+t.type),t.type){case x:if(!t.entry)throw new Error("tries to add an empty entry");return(e=[...e]).push(t.entry),e.sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e;case _:if(!t.entries)throw new Error("tries to add an empty entry");return(e=e.concat(t.entries)).sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e;case I:if(!t.entry)throw new Error("tries to remove an empty entry");return t.entry,e.filter(e=>e.id!==t.entry.id);case k:if(!t.entries)throw new Error("tries to set the state to null|undefined");return t.entries}return e},generatorReducer:function(e=[],t){return E.log("call repeat-reducer with action "+t.type),e}}));var R=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};const B=h.createInstance({name:"entry"});function M(e){return R(this,void 0,void 0,function*(){return g.log("add entry"),yield B.setItem(e.id,e),e})}var P=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};function j(){return P(this,void 0,void 0,function*(){let e=yield function(){return R(this,void 0,void 0,function*(){g.log("get all entries");let e=[];return yield B.iterate(t=>{e.push(t)}),e.sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e})}();O.dispatch(function(e){return E.log("create setentries action"),{type:k,entries:e}}(e))})}function A(){return P(this,void 0,void 0,function*(){let e=yield function(){return w(this,void 0,void 0,function*(){g.log("get all repeats");let e=[];return yield b.iterate(t=>{e.push(t)}),e})}();return O.dispatch(function(e){return E.log("create setentries action"),{type:D,repeats:e}}(e)),e})}function N(e,t){return P(this,void 0,void 0,function*(){let n=new Date(e.begin),a=t||new Date<new Date(e.end)?new Date:new Date(e.end);a=new Date(a.setDate(a.getDate()+1));let r=[];for(;n<a;)"weekly"===e.repeattype?e.repeats.indexOf(n.getDay())>=0&&r.push(Object.assign({},e.template,{date:n.toISOString()})):e.repeats.indexOf(n.getDate())>=0&&r.push(Object.assign({},e.template,{date:n.toISOString()})),n.setDate(n.getDate()+1);return r})}function H(){return P(this,void 0,void 0,function*(){let e=yield A();for(const t of e){let e=yield N(t);console.log(e),e.map(e=>(e.id=d(),e)),yield W(e);let n=new Date;n.setDate(n.getDate()+1),t.begin=n.toISOString(),yield $(t)}})}function L(e){return P(this,void 0,void 0,function*(){yield M(e),O.dispatch(function(e){return E.log("create add action"),{type:x,entry:e}}(e))})}function W(e){return P(this,void 0,void 0,function*(){O.dispatch(function(e){return E.log("create setentries action"),{type:_,entries:e}}(e));for(let t of e)yield M(t)})}function $(e){return P(this,void 0,void 0,function*(){yield S(e)})}var F=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};class z extends r.a.Component{constructor(e){v.construct("addpage"),super(e),this.input_entry={date:(new Date).toISOString(),id:"",note:"",value:0,category:"default"},this.input_repeat={begin:(new Date).toISOString(),end:(new Date).toISOString(),id:"",template:this.input_entry,repeats:[],repeattype:"weekly"},this.state={pagestate:"entry",repeattype:"weekly"},this.handleSubmit=this.handleSubmit.bind(this),this.renderToolbar=this.renderToolbar.bind(this),this.renderRepeatInput=this.renderRepeatInput.bind(this),this.renderBottomToolbar=this.renderBottomToolbar.bind(this)}render(){return"backToHome"===this.state.pagestate?r.a.createElement(u.a,{to:"/"}):r.a.createElement(s.Page,{renderToolbar:this.renderToolbar,renderBottomToolbar:this.renderBottomToolbar},r.a.createElement(s.Card,null,r.a.createElement(s.Row,null,r.a.createElement(s.Col,{style:{lineHeight:"24px"}},"Wiederholung"),r.a.createElement(s.Switch,{onChange:()=>this.setState({pagestate:"entry"!==this.state.pagestate?"entry":"repeat"})}))),"entry"===this.state.pagestate&&this.renderEntryInput(),"repeat"===this.state.pagestate&&this.renderRepeatInput())}renderToolbar(){return r.a.createElement(s.Toolbar,null,r.a.createElement(s.ToolbarButton,{onClick:()=>this.setState({pagestate:"backToHome"})},r.a.createElement(s.BackButton,null)),r.a.createElement("h4",{style:{margin:0,lineHeight:"60px"}},"Erstelle ","entry"===this.state.pagestate?"Eintrag":"Wiederholung"))}renderBottomToolbar(){return r.a.createElement(s.BottomToolbar,null,r.a.createElement(s.ToolbarButton,{style:{margin:0,padding:0,lineHeight:"44px",width:"100%",textAlign:"center"},onClick:this.handleSubmit},"Hinzufügen"))}renderEntryInput(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},placeholder:"Kategorie:",onChange:e=>this.input_entry.category=e.target.value})),r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},type:"date",placeholder:"Datum:",onChange:e=>this.input_entry.date=new Date(e.target.value).toISOString()})),r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},type:"number",placeholder:"Wert:",onChange:e=>this.input_entry.value=Number(e.target.value)})))}renderRepeatInput(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},placeholder:"Kategorie:",onChange:e=>this.input_entry.category=e.target.value})),r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},type:"number",placeholder:"Wert:",onChange:e=>this.input_entry.value=Number(e.target.value)})),r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},type:"date",placeholder:"Begin:",onChange:e=>this.input_repeat.begin=new Date(e.target.value).toISOString()})),r.a.createElement(s.Card,null,r.a.createElement(s.Input,{style:{width:"100%"},type:"date",placeholder:"Ende:",onChange:e=>this.input_repeat.end=new Date(e.target.value).toISOString()})),r.a.createElement(s.Card,null,r.a.createElement(s.Row,null,r.a.createElement(s.Col,null,r.a.createElement(s.Button,{modifier:"weekly"===this.state.repeattype?"cta":"light",style:{width:"100%"},onClick:()=>this.setState({repeattype:"weekly"})},"Wöchentlich")),r.a.createElement(s.Col,null,r.a.createElement(s.Button,{modifier:"weekly"!==this.state.repeattype?"cta":"light",style:{width:"100%"},onClick:()=>this.setState({repeattype:"monthly"})},"Monatlich")))),"weekly"===this.state.repeattype&&r.a.createElement(s.Card,null,r.a.createElement(s.Select,{id:"weeklyrepeats",style:{width:"100%"},multiple:!0,onChange:e=>{let t=document.querySelectorAll("#weeklyrepeats option:checked");this.input_repeat.repeats=Array.from(t).map(e=>Number(e.value))}},r.a.createElement("option",{value:"1"},"Montag"),r.a.createElement("option",{value:"2"},"Dienstag"),r.a.createElement("option",{value:"3"},"Mittwoch"),r.a.createElement("option",{value:"4"},"Donnerstag"),r.a.createElement("option",{value:"5"},"Freitag"),r.a.createElement("option",{value:"6"},"Samstag"),r.a.createElement("option",{value:"0"},"Sonntag"))),"monthly"===this.state.repeattype&&r.a.createElement(s.Card,null,r.a.createElement(s.Select,{id:"monthlyrepeats",style:{width:"100%"},multiple:!0,onChange:e=>{let t=document.querySelectorAll("#monthlyrepeats option:checked");this.input_repeat.repeats=Array.from(t).map(e=>Number(e.value))}},r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5"),r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"7"},"7"),r.a.createElement("option",{value:"8"},"8"),r.a.createElement("option",{value:"9"},"9"),r.a.createElement("option",{value:"10"},"10"),r.a.createElement("option",{value:"11"},"11"),r.a.createElement("option",{value:"12"},"12"),r.a.createElement("option",{value:"13"},"13"),r.a.createElement("option",{value:"14"},"14"),r.a.createElement("option",{value:"15"},"15"),r.a.createElement("option",{value:"16"},"16"),r.a.createElement("option",{value:"17"},"17"),r.a.createElement("option",{value:"18"},"18"),r.a.createElement("option",{value:"19"},"19"),r.a.createElement("option",{value:"20"},"20"),r.a.createElement("option",{value:"21"},"21"),r.a.createElement("option",{value:"22"},"22"),r.a.createElement("option",{value:"23"},"23"),r.a.createElement("option",{value:"24"},"24"),r.a.createElement("option",{value:"25"},"25"),r.a.createElement("option",{value:"26"},"26"),r.a.createElement("option",{value:"27"},"27"),r.a.createElement("option",{value:"28"},"28"))))}handleSubmit(){return F(this,void 0,void 0,function*(){if("entry"===this.state.pagestate){const e=Object.assign({},this.input_entry,{id:d()});yield L(e)}else{const e=Object.assign({},this.input_repeat,{id:d(),repeattype:this.state.repeattype});yield S(e),O.dispatch(function(e){return E.log("create add action"),{type:T,repeat:e}}(e))}this.setState({pagestate:"backToHome"})})}}n(32),n(33);var q=n(11);let J=0;const K=[["version: 0.1.0",void 0]],U=Object(q.b)(function(e){return{entries:e.entryReducer,repeats:e.repeatsReducer}},null)(class extends r.a.Component{constructor(e){v.construct("homepage"),super(e),this.state={total:0,slice:0,openMenu:!1},H(),this.MenuLeft=this.MenuLeft.bind(this),this.renderToolbar=this.renderToolbar.bind(this),this.renderBottomToolbar=this.renderBottomToolbar.bind(this)}render(){if(this.state.redirect)return r.a.createElement(u.a,{to:this.state.redirect});v.info("RENDER homepage");let e=[];return r.a.createElement(s.Splitter,null,r.a.createElement(s.SplitterSide,{side:"left",collapse:!0,width:200,isOpen:this.state.openMenu,onClose:()=>{this.setState({openMenu:!1})},swipeable:!0},r.a.createElement(s.Page,null,r.a.createElement(this.MenuLeft,null))),r.a.createElement(s.SplitterContent,null,r.a.createElement(s.Page,{renderToolbar:this.renderToolbar,renderBottomToolbar:this.renderBottomToolbar},r.a.createElement(s.List,{dataSource:this.props.entries.slice(20*this.state.slice,20*(1+this.state.slice)),renderRow:t=>(e.indexOf(new Date(t.date).toDateString()),r.a.createElement(r.a.Fragment,{key:t.id||`tmp_${++J}`},e.indexOf(new Date(t.date).toDateString())<0&&(()=>(e.push(new Date(t.date).toDateString()),!0))()&&r.a.createElement(s.ListItem,{className:"homepage_date",modifier:"nodivider"},r.a.createElement(s.Row,null,r.a.createElement(s.Col,null,new Date(t.date).toDateString()))),r.a.createElement(s.ListItem,{modifier:"longdivider"},r.a.createElement(s.Row,null,r.a.createElement(s.Col,null,t.category),r.a.createElement(s.Col,{width:"100px"},t.value,"€"),r.a.createElement(s.Col,{width:"40px"},r.a.createElement(s.Button,{onClick:()=>{!function(e){R(this,void 0,void 0,function*(){return g.log("remove entry "+e.id),yield B.removeItem(e.id),e})}(t),O.dispatch(function(e){return E.log("create remove action"),{type:I,entry:e}}(t))}},r.a.createElement(s.Icon,{icon:"md-delete"})))))))}),r.a.createElement(s.Fab,{style:{position:"fixed",bottom:"50px",right:"10px"},onClick:()=>this.setState({redirect:"/add"})},r.a.createElement(s.Icon,{icon:{default:"fa-plus"},size:{default:32}})))))}MenuLeft(){return r.a.createElement(s.List,{dataSource:K,renderRow:e=>r.a.createElement(s.ListItem,{key:"tmp_"+ ++J,onClick:()=>{e[1]&&this.setState({redirect:e[1]})}},e[0])})}renderToolbar(){return r.a.createElement(s.Toolbar,null,r.a.createElement(s.ToolbarButton,{onClick:()=>this.setState({openMenu:!0})},r.a.createElement(s.Icon,{icon:{default:"ion-navicon"},size:{default:50}})),r.a.createElement("h3",{style:{paddingRight:"20px",margin:0,lineHeight:"60px",textAlign:"right",width:"100%"}},function(e){let t=0;for(const n of e)t+=n.value;return t}(this.props.entries)," €"))}renderBottomToolbar(){return r.a.createElement(s.BottomToolbar,null,r.a.createElement(s.Row,null,r.a.createElement(s.ToolbarButton,{onClick:()=>this.setState({slice:0===this.state.slice?this.state.slice:this.state.slice-1})},r.a.createElement(s.Icon,{icon:{default:"ion-chevron-left"},size:{default:30},style:{paddingTop:"5px"}})),r.a.createElement(s.Col,{style:{textAlign:"center",lineHeight:"44px"}},20*this.state.slice+1,"-",20*(1+this.state.slice)," von ",this.props.entries.length),r.a.createElement(s.ToolbarButton,{onClick:()=>this.setState({slice:20*(this.state.slice+1)<this.props.entries.length?this.state.slice+1:this.state.slice})},r.a.createElement(s.Icon,{icon:{default:"ion-chevron-right"},size:{default:30},style:{paddingTop:"5px"}}))))}});n(35);var Y=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,l)}c((a=a.apply(e,t||[])).next())})};v.log("Start app"),i.a.render(r.a.createElement(function(){return r.a.createElement(q.a,{store:O},r.a.createElement(l.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{exact:!0,path:"/",component:U}),r.a.createElement(c.a,{exact:!0,path:"/add",component:z}))))},null),document.getElementById("app")),(()=>Y(void 0,void 0,void 0,function*(){yield H(),yield j()}))(),"serviceWorker"in window.navigator&&navigator.serviceWorker.register("sw.js")}});
//# sourceMappingURL=pwa.0.1.0.js.map