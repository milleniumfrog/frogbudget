!function(e){function t(t){for(var a,o,l=t[0],c=t[1],u=t[2],d=0,p=[];d<l.length;d++)o=l[d],r[o]&&p.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(s&&s(t);p.length;)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,l=1;l<n.length;l++){var c=n[l];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={0:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var s=c;i.push([39,2]),n()}({37:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),o=n.n(i),l=n(43),c=n(42),u=n(44),s=n(41),d=n(1);let p=Number(localStorage.getItem("entry_id"))||0;function m(){const e=String(++p);return localStorage.setItem("entry_id",e),e}var h=n(9),f=n(21),y=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};class g extends f.a{constructor(e={}){e.placeholders=[{keys:["{{timestamp}}"],flags:"gi",replacer:()=>{let e=new Date;return`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`}},{keys:["{{service}}"],flags:"gi",replacer:(e,t)=>t?`${t.service}`:"error_service"}],super(e)}construct(e){return y(this,void 0,void 0,function*(){return this.internals.service="CONSTRUCTOR",this.custom(this.options,this.internals,`Component ${e}`)})}}const v=new g({prefix:"{{timestamp}} [DB -- {{service}}] "}),E=new g({prefix:"{{timestamp}} [REDUX -- {{service}}] "}),w=new g({prefix:"{{timestamp}} [{{service}}] "});var S=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};const b=h.createInstance({name:"repeat"});function C(e){return S(this,void 0,void 0,function*(){return v.log("add Repeat"),yield b.setItem(e.id,e),e})}const D="ADD_REPEAT",I="SET_REPEATS";var x=n(8);const k="ADD_ENTRY",O="REMOVE_ENTRY",_="SET_ENTRIES",R="ADD_ENTRIES";let T=x.c(x.b({entryReducer:function(e=[],t){switch(E.log("call entry-reducer with action "+t.type),t.type){case k:if(!t.entry)throw new Error("tries to add an empty entry");return(e=[...e]).push(t.entry),e.sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e;case R:if(!t.entries)throw new Error("tries to add an empty entry");return(e=e.concat(t.entries)).sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e;case O:if(!t.entry)throw new Error("tries to remove an empty entry");return t.entry,e.filter(e=>e.id!==t.entry.id);case _:if(!t.entries)throw new Error("tries to set the state to null|undefined");return t.entries}return e},generatorReducer:function(e=[],t){return E.log("call repeat-reducer with action "+t.type),e}}));var M=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};const N=h.createInstance({name:"entry"});function P(e){return M(this,void 0,void 0,function*(){return v.log("add entry"),yield N.setItem(e.id,e),e})}var j=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};function B(){return j(this,void 0,void 0,function*(){let e=yield function(){return M(this,void 0,void 0,function*(){v.log("get all entries");let e=[];return yield N.iterate(t=>{e.push(t)}),e.sort((e,t)=>{const n=new Date(e.date);return new Date(t.date).getTime()-n.getTime()}),e})}();T.dispatch(function(e){return E.log("create setentries action"),{type:_,entries:e}}(e))})}function A(){return j(this,void 0,void 0,function*(){let e=yield function(){return S(this,void 0,void 0,function*(){v.log("get all repeats");let e=[];return yield b.iterate(t=>{e.push(t)}),e})}();return T.dispatch(function(e){return E.log("create setentries action"),{type:I,repeats:e}}(e)),e})}function L(e,t){return j(this,void 0,void 0,function*(){let n=new Date(e.begin),a=t||new Date<new Date(e.end)?new Date:new Date(e.end);a=new Date(a.setDate(a.getDate()+1));let r=[];for(;n<a;)"weekly"===e.repeattype?e.repeats.indexOf(n.getDay())>=0&&r.push(Object.assign({},e.template,{date:n.toISOString()})):e.repeats.indexOf(n.getDate())>=0&&r.push(Object.assign({},e.template,{date:n.toISOString()})),n.setDate(n.getDate()+1);return r})}function F(){return j(this,void 0,void 0,function*(){let e=yield A();for(const t of e){let e=yield L(t);console.log(e),e.map(e=>(e.id=m(),e)),yield W(e);let n=new Date;n.setDate(n.getDate()+1),t.begin=n.toISOString(),yield H(t)}})}function $(e){return j(this,void 0,void 0,function*(){yield P(e),T.dispatch(function(e){return E.log("create add action"),{type:k,entry:e}}(e))})}function W(e){return j(this,void 0,void 0,function*(){T.dispatch(function(e){return E.log("create setentries action"),{type:R,entries:e}}(e));for(let t of e)yield P(t)})}function H(e){return j(this,void 0,void 0,function*(){yield C(e)})}var z=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};class q extends r.a.Component{constructor(e){w.construct("addpage"),super(e),this.input_entry={date:(new Date).toISOString(),id:"",note:"",value:0,category:"default"},this.input_repeat={begin:(new Date).toISOString(),end:(new Date).toISOString(),id:"",template:this.input_entry,repeats:[],repeattype:"weekly"},this.state={pagestate:"entry",repeattype:"weekly"},this.handleSubmit=this.handleSubmit.bind(this),this.renderToolbar=this.renderToolbar.bind(this),this.renderRepeatInput=this.renderRepeatInput.bind(this)}render(){return"backToHome"===this.state.pagestate?r.a.createElement(u.a,{to:"/"}):r.a.createElement(d.Page,{renderToolbar:this.renderToolbar},"entry"===this.state.pagestate&&this.renderEntryInput(),"repeat"===this.state.pagestate&&this.renderRepeatInput(),r.a.createElement(d.Card,null,r.a.createElement(d.Button,{onClick:this.handleSubmit},"Hinzufügen")))}renderToolbar(){let e=Object(s.a)(({history:e})=>r.a.createElement(d.BackButton,{onClick:()=>e.push("/")}));return r.a.createElement(d.Toolbar,null,r.a.createElement("div",{className:"left"},r.a.createElement(e,null)),r.a.createElement(d.Row,{className:"center"},r.a.createElement(d.Col,{verticalAlign:"center"},r.a.createElement(d.Button,{modifier:"large--flat",className:"center",onClick:()=>this.setState({pagestate:"entry"})},"Eintrag")),r.a.createElement(d.Col,{verticalAlign:"center"},r.a.createElement(d.Button,{modifier:"large--flat",className:"center",onClick:()=>this.setState({pagestate:"repeat"})},"Wiederholungen"))))}renderEntryInput(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},placeholder:"Kategorie:",onChange:e=>this.input_entry.category=e.target.value})),r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},type:"date",placeholder:"Datum:",onChange:e=>this.input_entry.date=new Date(e.target.value).toISOString()})),r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},type:"number",placeholder:"Wert:",onChange:e=>this.input_entry.value=Number(e.target.value)})))}renderRepeatInput(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},placeholder:"Kategorie:",onChange:e=>this.input_entry.category=e.target.value})),r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},type:"number",placeholder:"Wert:",onChange:e=>this.input_entry.value=Number(e.target.value)})),r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},type:"date",placeholder:"Begin:",onChange:e=>this.input_repeat.begin=new Date(e.target.value).toISOString()})),r.a.createElement(d.Card,null,r.a.createElement(d.Input,{style:{width:"100%"},type:"date",placeholder:"Ende:",onChange:e=>this.input_repeat.end=new Date(e.target.value).toISOString()})),r.a.createElement(d.Card,null,r.a.createElement(d.Button,{modifier:"large--flat",onClick:()=>this.setState({repeattype:"weekly"})},"Wöchentlich"),r.a.createElement(d.Button,{onClick:()=>this.setState({repeattype:"monthly"})},"Monatlich")),"weekly"===this.state.repeattype&&r.a.createElement(d.Card,null,r.a.createElement(d.Select,{id:"weeklyrepeats",style:{width:"100%"},multiple:!0,onChange:e=>{let t=document.querySelectorAll("#weeklyrepeats option:checked");this.input_repeat.repeats=Array.from(t).map(e=>Number(e.value))}},r.a.createElement("option",{value:"1"},"Montag"),r.a.createElement("option",{value:"2"},"Dienstag"),r.a.createElement("option",{value:"3"},"Mittwoch"),r.a.createElement("option",{value:"4"},"Donnerstag"),r.a.createElement("option",{value:"5"},"Freitag"),r.a.createElement("option",{value:"6"},"Samstag"),r.a.createElement("option",{value:"0"},"Sonntag"))),"monthly"===this.state.repeattype&&r.a.createElement(d.Card,null,r.a.createElement(d.Select,{id:"monthlyrepeats",style:{width:"100%"},multiple:!0,onChange:e=>{let t=document.querySelectorAll("#monthlyrepeats option:checked");this.input_repeat.repeats=Array.from(t).map(e=>Number(e.value))}},r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5"),r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"7"},"7"),r.a.createElement("option",{value:"8"},"8"),r.a.createElement("option",{value:"9"},"9"),r.a.createElement("option",{value:"10"},"10"))))}handleSubmit(){return z(this,void 0,void 0,function*(){if("entry"===this.state.pagestate){const e=Object.assign({},this.input_entry,{id:m()});yield $(e)}else{const e=Object.assign({},this.input_repeat,{id:m(),repeattype:this.state.repeattype});yield C(e),T.dispatch(function(e){return E.log("create add action"),{type:D,repeat:e}}(e))}this.setState({pagestate:"backToHome"})})}}n(34),n(35);var J=n(11);let K=0;const U=[["version: 0.0.7",void 0]],V=Object(J.b)(function(e){return{entries:e.entryReducer,repeats:e.repeatsReducer}},null)(class extends r.a.Component{constructor(e){w.construct("homepage"),super(e),this.state={total:0,slice:0,openMenu:!1},F(),this.MenuLeft=this.MenuLeft.bind(this)}render(){if(this.state.redirect)return r.a.createElement(u.a,{to:this.state.redirect});w.info("RENDER homepage");let e=[];return r.a.createElement(d.Splitter,null,r.a.createElement(d.SplitterSide,{side:"left",collapse:!0,width:200,isOpen:this.state.openMenu,swipeable:!0},r.a.createElement(d.Page,null,r.a.createElement(this.MenuLeft,null))),r.a.createElement(d.SplitterContent,null,r.a.createElement(d.Page,null,r.a.createElement(d.Card,null,r.a.createElement(d.Row,null,r.a.createElement(d.Col,null,r.a.createElement(d.Button,{onClick:()=>{this.setState({openMenu:!0})}},r.a.createElement(d.Icon,{size:{default:32},icon:{default:"ion-navicon"}}))),r.a.createElement(d.Col,null,function(e){let t=0;for(const n of e)t+=n.value;return t}(this.props.entries).toFixed(2)," €"))),r.a.createElement(d.List,{dataSource:this.props.entries.slice(20*this.state.slice,20*(1+this.state.slice)),renderRow:t=>(e.indexOf(new Date(t.date).toDateString()),r.a.createElement(r.a.Fragment,{key:t.id||`tmp_${++K}`},e.indexOf(new Date(t.date).toDateString())<0&&(()=>(e.push(new Date(t.date).toDateString()),!0))()&&r.a.createElement(d.ListItem,{className:"homepage_date",modifier:"nodivider"},r.a.createElement(d.Row,null,r.a.createElement(d.Col,null,new Date(t.date).toDateString()))),r.a.createElement(d.ListItem,{modifier:"longdivider"},r.a.createElement(d.Row,null,r.a.createElement(d.Col,null,t.category),r.a.createElement(d.Col,{width:"100px"},t.value,"€"),r.a.createElement(d.Col,{width:"40px"},r.a.createElement(d.Button,{onClick:()=>{!function(e){M(this,void 0,void 0,function*(){return v.log("remove entry "+e.id),yield N.removeItem(e.id),e})}(t),T.dispatch(function(e){return E.log("create remove action"),{type:O,entry:e}}(t))}},r.a.createElement(d.Icon,{icon:"md-delete"})))))))}),r.a.createElement(d.Card,null,r.a.createElement(d.Button,{onClick:()=>{this.setState({slice:this.state.slice>0?this.state.slice-1:this.state.slice})}},"Vorherigen 20"),r.a.createElement(d.Button,{onClick:()=>{this.setState({slice:this.state.slice+1}),window.scrollTo(0,0)}},"Nächsten 20")),r.a.createElement(d.Fab,{style:{position:"fixed",bottom:"10px",right:"10px"},onClick:()=>this.setState({redirect:"/add"})},r.a.createElement(d.Icon,{icon:{default:"fa-plus"},size:{default:32}})))))}MenuLeft(){return r.a.createElement(d.List,{dataSource:U,renderRow:e=>r.a.createElement(d.ListItem,{key:"tmp_"+ ++K,onClick:()=>{e[1]&&this.setState({redirect:e[1]})}},e[0])})}});n(37);var Y=function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}c((a=a.apply(e,t||[])).next())})};w.log("Start app"),o.a.render(r.a.createElement(function(){return r.a.createElement(J.a,{store:T},r.a.createElement(l.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{exact:!0,path:"/",component:V}),r.a.createElement(c.a,{exact:!0,path:"/add",component:q}))))},null),document.getElementById("app")),(()=>Y(void 0,void 0,void 0,function*(){yield F(),yield B()}))(),"serviceWorker"in window.navigator&&navigator.serviceWorker.register("sw.js")}});
//# sourceMappingURL=pwa.0.0.7.js.map